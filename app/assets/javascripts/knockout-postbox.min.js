//knockout-postbox v0.1.0 | (c) 2012 Ryan Niemeyer | http://www.opensource.org/licenses/mit-license
(function(a,b){var c,d;a.postbox=new a.subscribable,a.postbox.topicCache={},a.postbox.publish=function(b,c){b&&(a.postbox.topicCache[b]=c,a.postbox.notifySubscribers(c,b))},d=a.postbox.subscribe,a.postbox.subscribe=function(b,c,e){if(b)return d.call(a.postbox,c,e,b)},a.postbox.defaultComparer=function(a,b){return b!==a},a.subscribable.fn.publishOn=function(b,d,e){var f;return b&&(typeof d=="function"?e=d:f=d,e=e||a.postbox.defaultComparer,c.call(this,b,"publishOn"),this.postboxSubs[b].publishOn=this.subscribe(function(c){e.call(this,c,a.postbox.topicCache[b])&&a.postbox.publish(b,c)},this),f||a.postbox.publish(b,this())),this},c=function(a,b){var c=this.postboxSubs=this.postboxSubs||{};c[a]=c[a]||{},c[a][b]&&c[a][b].dispose()},a.subscribable.fn.stopPublishingOn=function(a){return c.call(this,a,"publishOn"),this},a.subscribable.fn.subscribeTo=function(d,e,f){var g,h,i,j=this;return typeof e=="function"?f=e:g=e,d&&a.isWriteableObservable(this)&&(c.call(this,d,"subscribeTo"),i=function(a){j(f?f.call(j,a):a)},this.postboxSubs[d].subscribeTo=a.postbox.subscribe(d,i),g&&(h=a.postbox.topicCache[d],h!==b&&i(h))),this},a.subscribable.fn.unsubscribeFrom=function(a){return c.call(this,a,"subscribeTo"),this},a.subscribable.fn.syncWith=function(a,b,c,d){return this.subscribeTo(a,b).publishOn(a,c,d),this}})(ko)